---
phase: 08-mock-data-pitch-assets
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - scripts/seed/lib/supabase.ts
  - scripts/seed/lib/mux.ts
  - scripts/seed/lib/storage.ts
  - scripts/seed/data/creators.ts
  - scripts/seed/data/series.ts
  - scripts/seed/data/engagement.ts
  - scripts/seed/generate-thumbnails.ts
autonomous: true

must_haves:
  truths:
    - "Seed script helpers can connect to Supabase admin and Mux SDK outside of Next.js context"
    - "Mock data definitions contain 15-25 believable series across all 11 genre categories with creator personas"
    - "Each mock series has a compelling logline, unique episode titles, synopses, and varied pricing ($0.99-$7.99)"
    - "Creator personas have unique names, bios, avatars, social links, and backstories"
    - "A thumbnail generation script can produce AI thumbnails via fal.ai and save them locally"
  artifacts:
    - path: "scripts/seed/lib/supabase.ts"
      provides: "Standalone Supabase admin client for seed scripts"
      contains: "createClient.*SUPABASE_SERVICE_ROLE_KEY"
    - path: "scripts/seed/lib/mux.ts"
      provides: "Standalone Mux SDK client for seed scripts"
      contains: "new Mux"
    - path: "scripts/seed/lib/storage.ts"
      provides: "Thumbnail upload + public URL helper for Supabase Storage"
      contains: "uploadThumbnail"
    - path: "scripts/seed/data/creators.ts"
      provides: "10-15 creator persona definitions with full profiles"
      contains: "MOCK_CREATORS"
    - path: "scripts/seed/data/series.ts"
      provides: "15-25 series definitions across all genres with seasons and episodes"
      contains: "MOCK_SERIES"
    - path: "scripts/seed/data/engagement.ts"
      provides: "Engagement data generation functions for view counts, purchases, followers"
      contains: "generateEngagement"
    - path: "scripts/seed/generate-thumbnails.ts"
      provides: "fal.ai thumbnail generation script that saves images locally"
      contains: "fal-ai/flux"
  key_links:
    - from: "scripts/seed/lib/supabase.ts"
      to: "Supabase env vars"
      via: "process.env.NEXT_PUBLIC_SUPABASE_URL + SUPABASE_SERVICE_ROLE_KEY"
      pattern: "createClient.*process\\.env"
    - from: "scripts/seed/data/series.ts"
      to: "scripts/seed/data/creators.ts"
      via: "Creator IDs referenced as series.creatorIndex"
      pattern: "creatorIndex"
---

<objective>
Build the seed script infrastructure and comprehensive mock data definitions for populating MicroShort with 15-25 believable series across all genre categories.

Purpose: Establish the data layer and helper utilities that the seed execution script (08-02) will use to populate the platform. This plan creates all mock content definitions and service connection helpers, but does NOT execute them against the database.

Output: scripts/seed/ directory with service helpers (Supabase admin, Mux, Storage), complete mock data definitions (creators, series catalog, engagement metrics), and a standalone fal.ai thumbnail generation script.
</objective>

<execution_context>
@/Users/solofilms/.claude/get-shit-done/workflows/execute-plan.md
@/Users/solofilms/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-mock-data-pitch-assets/08-RESEARCH.md
@src/db/schema.sql
@src/db/types.ts
@src/config/genres.ts
@src/lib/supabase/admin.ts
@src/lib/mux/client.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create seed script helpers and install dependencies</name>
  <files>
    scripts/seed/lib/supabase.ts
    scripts/seed/lib/mux.ts
    scripts/seed/lib/storage.ts
    scripts/seed/generate-thumbnails.ts
    package.json
  </files>
  <action>
    **Install dependencies:**
    ```bash
    pnpm add -D tsx
    pnpm add @fal-ai/client
    ```
    Note: tsx is a devDependency for running TypeScript scripts directly. @fal-ai/client is for the thumbnail generation script only.

    **Create scripts/seed/lib/supabase.ts:**
    Standalone Supabase admin client (NOT importing from src/lib/supabase/admin.ts -- seed scripts must not import from the Next.js app). Pattern:
    ```typescript
    import { createClient } from "@supabase/supabase-js";
    // Validate env vars, create client with service role key
    // auth: { autoRefreshToken: false, persistSession: false }
    ```
    Use `--env-file=.env.local` flag when running via tsx (see package.json scripts in 08-02), so env vars are available via process.env.

    **Create scripts/seed/lib/mux.ts:**
    Standalone Mux SDK client:
    ```typescript
    import Mux from "@mux/mux-node";
    export const mux = new Mux(); // Auto-reads MUX_TOKEN_ID + MUX_TOKEN_SECRET from env
    ```

    **Create scripts/seed/lib/storage.ts:**
    Helper functions for Supabase Storage operations:
    - `uploadThumbnail(adminDb, localPath, storagePath)` -- reads local file, uploads to Supabase Storage thumbnails bucket with `upsert: true`, returns public URL
    - `getPublicUrl(adminDb, bucket, path)` -- returns public URL for a storage path
    - Use `contentType: "image/png"` and `cacheControl: "3600"`
    - Follow existing path convention: `{creator_id}/{filename}` for storage paths (matches existing RLS policy structure, though admin client bypasses RLS)

    **Create scripts/seed/generate-thumbnails.ts:**
    One-time script for generating AI thumbnails via fal.ai Flux model:
    - Import fal.ai client, configure with FAL_KEY from env
    - Accept series data as input (import from data/series.ts)
    - For each series, generate a thumbnail using `fal.subscribe("fal-ai/flux/dev", { input: { prompt, image_size: "landscape_16_9" } })`
    - Download the generated image and save to `scripts/seed/assets/thumbnails/{series-slug}.png`
    - Create the assets/thumbnails directory if it doesn't exist
    - Use sequential processing with 2-3 second delay between requests to avoid rate limits
    - Build prompts from series data: combine genre, title, and description into cinematic thumbnail prompts
    - Log progress for each thumbnail generated
    - This script runs ONCE, outputs are committed to repo. NOT run on every seed.

    **Add .gitkeep to scripts/seed/assets/thumbnails/** to ensure directory exists in git.
  </action>
  <verify>
    - `ls scripts/seed/lib/supabase.ts scripts/seed/lib/mux.ts scripts/seed/lib/storage.ts` -- all files exist
    - `ls scripts/seed/generate-thumbnails.ts` -- thumbnail script exists
    - `pnpm exec tsx --version` -- tsx installed and runnable
    - `grep "@fal-ai/client" package.json` -- fal.ai client installed
    - TypeScript compiles: `pnpm exec tsc --noEmit scripts/seed/lib/supabase.ts 2>&1 || true` (may need tsconfig path adjustment -- verify no import errors)
  </verify>
  <done>
    Seed script helper files exist at scripts/seed/lib/{supabase,mux,storage}.ts with standalone clients. Thumbnail generation script exists at scripts/seed/generate-thumbnails.ts. Dependencies tsx and @fal-ai/client are installed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create comprehensive mock data definitions</name>
  <files>
    scripts/seed/data/creators.ts
    scripts/seed/data/series.ts
    scripts/seed/data/engagement.ts
  </files>
  <action>
    **Create scripts/seed/data/creators.ts:**
    Define 10-15 MOCK_CREATORS array. Each creator object:
    ```typescript
    {
      email: "creator-slug@mock.microshort.dev",  // Deterministic for idempotency
      password: "MockCreator123!",                 // Same for all mock creators (dev only)
      username: "mock_janedirector",               // Prefixed with mock_ for clear identification and easy cleanup
      displayName: "Jane Director",
      bio: "Award-winning micro-filmmaker specializing in...",
      avatarUrl: null,                              // Will use Supabase Storage path after upload
      socialLinks: { "twitter.com": "https://twitter.com/janedirector", "instagram.com": "https://instagram.com/janedirector" },
    }
    ```
    Requirements per locked decisions:
    - Full creator personas: unique names, bios, social links, backstories
    - Mix of creator types reflecting target audience: AI filmmakers, comedy creators, indie studios, music producers, sports documentarians, etc.
    - Each persona should feel like a real person with a distinct creative voice

    **Create scripts/seed/data/series.ts:**
    Define MOCK_SERIES array of 18-22 series (aiming for 20, covering all 11 genres with at least 1-2 per genre). Each series object:
    ```typescript
    {
      slug: "mock-signal-lost",                    // Prefixed with mock- for clear cleanup
      title: "SIGNAL LOST",
      description: "When Earth's only contact with a distant colony goes silent...",
      genre: "sci-fi" as Genre,
      creatorIndex: 0,                              // Index into MOCK_CREATORS array
      isHeroSeries: true,                           // Only ONE series (sci-fi) is the hero demo series
      seasons: [
        {
          seasonNumber: 1,
          title: "First Contact",
          description: "The mystery begins...",
          priceCents: 499,                          // $4.99
          episodes: [
            { title: "Static", description: "A routine check-in becomes anything but..." },
            { title: "Echo", description: "The signal repeats, but something has changed..." },
            // ... at least 8 episodes per season (DB trigger requires 8-70 for published)
          ]
        }
      ]
    }
    ```
    Requirements per locked decisions:
    - Even genre coverage: at least 1-2 series per genre (Drama, Comedy, Thriller, Sci-Fi, Horror, Romance, Action, Documentary, BTS, Music, Sports)
    - Mix of 1-3 seasons per series
    - Varied pricing: $0.99-$7.99 range (use price_cents: 99, 199, 299, 399, 499, 599, 699, 799)
    - The ONE hero series is sci-fi ("SIGNAL LOST" per research recommendation) with `isHeroSeries: true`
    - Each episode needs at least title and description (synopsis)
    - Each season needs at least 8 episodes to satisfy the published season trigger
    - Each series needs a compelling logline (in description field)

    **Genre distribution target:**
    - Drama: 2 series
    - Comedy: 2 series
    - Thriller: 2 series
    - Sci-Fi: 2 series (one is SIGNAL LOST hero)
    - Horror: 1-2 series
    - Romance: 1-2 series
    - Action: 2 series
    - Documentary: 1-2 series
    - BTS: 1 series
    - Music: 1-2 series
    - Sports: 1 series
    Total: ~20 series

    **Create scripts/seed/data/engagement.ts:**
    Define engagement data generation functions:
    - `generateViewCounts(seriesCount)` -- returns realistic view counts (hundreds to low thousands) per series, with hero series having highest counts
    - `generatePurchaseCounts(seriesCount)` -- returns purchase count estimates per season
    - `generateFollowerCounts(creatorCount)` -- returns follower counts for creator profiles (dozens to hundreds)
    - Numbers should feel realistic for an early-stage platform: hero series 2,000-5,000 views, popular series 500-2,000, newer series 100-500
    - Export a `generateEngagement()` function that produces the full engagement dataset

    All data definitions are pure TypeScript -- no database calls, no side effects. They export typed arrays and functions that the seed execution script (08-02) will consume.
  </action>
  <verify>
    - `ls scripts/seed/data/creators.ts scripts/seed/data/series.ts scripts/seed/data/engagement.ts` -- all files exist
    - `grep -c "mock_" scripts/seed/data/creators.ts` -- returns 10+ (at least 10 creators)
    - `grep -c "mock-" scripts/seed/data/series.ts` -- returns 15+ (at least 15 series slugs)
    - Verify all 11 genres are represented: `grep -E "drama|comedy|thriller|sci-fi|horror|romance|action|documentary|behind-the-scenes|music|sports" scripts/seed/data/series.ts | wc -l` shows 11+ unique genres
    - `grep "isHeroSeries.*true" scripts/seed/data/series.ts` -- exactly one hero series exists
    - Verify episode counts: each season definition in series.ts has at least 8 episode objects
  </verify>
  <done>
    Mock data files define 10-15 creator personas with full profiles, 18-22 series across all 11 genre categories with varied pricing ($0.99-$7.99), seasons with 8+ episodes each, and engagement data generators. SIGNAL LOST is designated as the sole hero demo series. All data is pure TypeScript definitions with no side effects.
  </done>
</task>

</tasks>

<verification>
- scripts/seed/lib/ directory contains standalone Supabase, Mux, and Storage helpers
- scripts/seed/data/ directory contains creators, series, and engagement definitions
- scripts/seed/generate-thumbnails.ts exists for one-time fal.ai thumbnail generation
- tsx and @fal-ai/client dependencies are installed
- Mock data covers all 11 genres with at least 1-2 series each
- All series have at least 8 episodes per season
- One sci-fi hero series (SIGNAL LOST) is marked with isHeroSeries flag
- Creator personas have unique names, bios, social links
- Pricing varies across $0.99-$7.99 range
</verification>

<success_criteria>
The complete seed data layer and helper infrastructure is ready for the execution script (08-02) to consume. Running `ls scripts/seed/` shows lib/, data/, generate-thumbnails.ts, and assets/ directories. Mock data definitions are comprehensive, believable, and cover all requirements.
</success_criteria>

<output>
After completion, create `.planning/phases/08-mock-data-pitch-assets/08-01-SUMMARY.md`
</output>
